{"version":3,"sources":["webpack:///./src/views/ProposalPage.vue?fab4","webpack:///./src/views/ProposalPage.vue?3d4f","webpack:///src/views/ProposalPage.vue","webpack:///./src/views/ProposalPage.vue?c7a1","webpack:///./src/views/ProposalPage.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","ref","on","onLogin","onLogout","staticClass","_v","_s","proposal","subject","style","backgroundImage","image","creator","image_receiver","receiver","attrs","url","start_date","end_date","total_time","daily_pay","total_pay","status","status_extended","votes_sp","$store","state","auth","saving","vote","_e","display_button","alert","infoText","domProps","successText","dangerText","votes","length","directives","name","rawName","value","expression","$event","$$selectedVal","Array","prototype","filter","call","target","options","o","selected","map","val","_value","sort_order","multiple","_l","index","key","voter","votes_description","staticRenderFns","data","components","HeaderEFTG","mixins","created","getChainProperties","then","watch","methods","sortBy","sort","Error","isActive","now","Date","witness_vote_weight","no_proxy_vote_weight","account","proxy_vote_weight","Math","floor","parseFloat","vesting_shares","total","parseInt","proxied_vsf_votes","i","calculate_vote","no_proxy_votes","proxy_votes","witnessVotes2sp","user","activeKey","keys","active","ownerKey","privKey","id","$route","params","showDanger","ops","hideSuccess","hideDanger","hideInfo","steem_broadcast_sendOperations","self","showSuccess","loadVotesFromAccount","error","message","console","log","component"],"mappings":"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","file":"js/chunk-51e35d80.977ef976.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=style&index=0&id=7d5ad6e1&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=style&index=0&id=7d5ad6e1&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('HeaderEFTG',{ref:\"headerEFTG\",on:{\"login\":_vm.onLogin,\"logout\":_vm.onLogout}}),_c('div',{staticClass:\"container\"},[_c('h2',[_vm._v(_vm._s(_vm.proposal.subject))]),_c('div',{staticClass:\"row mt-3 mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Creator\")]),_c('div',{staticClass:\"col-10\"},[_c('div',{staticClass:\"image-profile mr-2\",style:({ backgroundImage: 'url(' + _vm.proposal.image + ')' })}),_c('span',[_vm._v(_vm._s(_vm.proposal.creator))])])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Receiver\")]),_c('div',{staticClass:\"col-10\"},[_c('div',{staticClass:\"image-profile mr-2\",style:({ backgroundImage: 'url(' + _vm.proposal.image_receiver + ')' })}),_c('span',[_vm._v(_vm._s(_vm.proposal.receiver))])])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Subject\")]),_c('div',{staticClass:\"col-10\"},[_c('router-link',{attrs:{\"to\":_vm.proposal.url}},[_vm._v(_vm._s(_vm.proposal.subject))])],1)]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Start date\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.start_date))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"End date\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.end_date))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Total days\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.total_time))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Daily pay\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.daily_pay))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Total pay\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.total_pay))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Status\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.status)+\" \"+_vm._s(_vm.proposal.status_extended))])]),_c('div',{staticClass:\"row mb-2\"},[_c('div',{staticClass:\"col-2\"},[_vm._v(\"Votes\")]),_c('div',{staticClass:\"col-10\"},[_vm._v(_vm._s(_vm.proposal.votes_sp))])]),(this.$store.state.auth.logged)?_c('div',{staticClass:\"row mt-4\"},[_c('div',{staticClass:\"form-group col-12\"},[_c('button',{staticClass:\"btn btn-primary btn-large mr-2\",attrs:{\"disabled\":_vm.saving},on:{\"click\":_vm.vote}},[(_vm.saving)?_c('div',{staticClass:\"mini loader\"}):_vm._e(),_vm._v(_vm._s(_vm.display_button))])])]):_vm._e(),(_vm.alert.info)?_c('div',{staticClass:\"alert alert-info\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.infoText))]):_vm._e(),(_vm.alert.success)?_c('div',{staticClass:\"alert alert-success\",attrs:{\"role\":\"alert\"},domProps:{\"innerHTML\":_vm._s(_vm.alert.successText)}}):_vm._e(),(_vm.alert.danger)?_c('div',{staticClass:\"alert alert-danger\",attrs:{\"role\":\"alert\"}},[_vm._v(_vm._s(_vm.alert.dangerText))]):_vm._e(),_c('h3',{staticClass:\"mt-5\"},[_vm._v(_vm._s(_vm.votes.length)+\" Votes\")]),_c('div',{staticClass:\"row mb-3\"},[_c('div',{staticClass:\"col-12 text-right\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.sort_order),expression:\"sort_order\"}],on:{\"change\":function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.sort_order=$event.target.multiple ? $$selectedVal : $$selectedVal[0]}}},[_c('option',{attrs:{\"value\":\"votes\"}},[_vm._v(\"Sort by votes\")]),_c('option',{attrs:{\"value\":\"name\"}},[_vm._v(\"Sort by name\")])])])]),_c('div',{staticClass:\"card mb-2\"},[_c('ul',{staticClass:\"list-group list-group-flush\"},_vm._l((_vm.votes),function(vote,index){return _c('li',{key:index,staticClass:\"list-group-item\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-3\"},[_vm._v(\"@\"+_vm._s(vote.voter))]),_c('div',{staticClass:\"col-2\"},[_vm._v(_vm._s(vote.votes_sp))]),_c('div',{staticClass:\"col-7\"},[_vm._v(_vm._s(vote.votes_description))])])])}),0)])])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <HeaderEFTG ref=\"headerEFTG\" v-on:login=\"onLogin\" v-on:logout=\"onLogout\"></HeaderEFTG>\n    <div class=\"container\">\n      <h2>{{proposal.subject}}</h2>\n      <div class=\"row mt-3 mb-2\">\n        <div class=\"col-2\">Creator</div>\n        <div class=\"col-10\">\n          <div class=\"image-profile mr-2\" :style=\"{ backgroundImage: 'url(' + proposal.image + ')' }\"></div>\n          <span>{{proposal.creator}}</span>\n        </div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Receiver</div>\n        <div class=\"col-10\">\n          <div class=\"image-profile mr-2\" :style=\"{ backgroundImage: 'url(' + proposal.image_receiver + ')' }\"></div>\n          <span>{{proposal.receiver}}</span>\n        </div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Subject</div>\n        <div class=\"col-10\">\n          <router-link :to=\"proposal.url\">{{proposal.subject}}</router-link>\n        </div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Start date</div>\n        <div class=\"col-10\">{{proposal.start_date}}</div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">End date</div>\n        <div class=\"col-10\">{{proposal.end_date}}</div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Total days</div>\n        <div class=\"col-10\">{{proposal.total_time}}</div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Daily pay</div>\n        <div class=\"col-10\">{{proposal.daily_pay}}</div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Total pay</div>\n        <div class=\"col-10\">{{proposal.total_pay}}</div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Status</div>\n        <div class=\"col-10\">{{proposal.status}} {{proposal.status_extended}}</div>\n      </div>\n      <div class=\"row mb-2\">\n        <div class=\"col-2\">Votes</div>\n        <div class=\"col-10\">{{proposal.votes_sp}}</div>\n      </div>\n      <div v-if=\"this.$store.state.auth.logged\" class=\"row mt-4\">\n        <div class=\"form-group col-12\">\n          <button @click=\"vote\" class=\"btn btn-primary btn-large mr-2\" :disabled=\"saving\"><div v-if=\"saving\" class=\"mini loader\"></div>{{display_button}}</button>\n        </div>\n      </div>\n      <div v-if=\"alert.info\" class=\"alert alert-info\" role=\"alert\">{{alert.infoText}}</div>\n      <div v-if=\"alert.success\" class=\"alert alert-success\" role=\"alert\" v-html=\"alert.successText\"></div>\n      <div v-if=\"alert.danger\"  class=\"alert alert-danger\" role=\"alert\">{{alert.dangerText}}</div>\n\n      <h3 class=\"mt-5\">{{votes.length}} Votes</h3>\n      <div class=\"row mb-3\">\n        <div class=\"col-12 text-right\">\n          <select v-model=\"sort_order\">\n            <option value=\"votes\">Sort by votes</option>\n            <option value=\"name\">Sort by name</option>\n          </select>\n        </div>\n      </div>\n      <div class=\"card mb-2\">\n        <ul class=\"list-group list-group-flush\">\n          <li v-for=\"(vote,index) in votes\" :key=\"index\" class=\"list-group-item\">\n            <div class=\"row\">\n              <div class=\"col-3\">@{{vote.voter}}</div>\n              <div class=\"col-2\">{{vote.votes_sp}}</div>\n              <div class=\"col-7\">{{vote.votes_description}}</div>\n            </div>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport HeaderEFTG from '@/components/HeaderEFTG'\nimport SteemClient from '@/mixins/SteemClient.js'\nimport Alerts from '@/mixins/Alerts.js'\nimport Utils from '@/js/utils.js'\n\nimport Config from '@/config.js'\nimport ChainProperties from '@/mixins/ChainProperties.js'\n\n\nexport default {\n  name: 'ProposalPage',\n\n  data() {\n    return {\n      proposal: {url:''},\n      votes: [],\n      sort_order: 'votes',\n      display_button: 'Vote',\n      saving: false,\n    }\n  },\n\n  components: {\n    HeaderEFTG\n  },\n\n  mixins: [\n    ChainProperties,\n    SteemClient,\n    Alerts\n  ],\n\n  created() {\n    this.getChainProperties().then( ()=>{\n      this.getProposal()\n    })\n  },\n\n  watch: {\n    sort_order: function(new_order){ this.sortBy(new_order) },\n  },\n\n  methods: {\n    async getProposal(){\n      var id = this.$route.params.id\n      var proposals = await this.steem_database_call('find_proposals',[[id]])\n      console.log(proposals)\n      if(!proposals || proposals.length==0){\n        this.showDanger(`Proposal number #${id} does not exists`)\n        throw new Error(`Proposal number #${id} does not exists`)\n      }\n      var proposal = proposals[0]\n      var delta_t = new Date(proposal.end_date) - new Date(proposal.start_date)\n      proposal.url = Config.EXPLORER + '@' + proposal.creator + '/' + proposal.permlink\n      proposal.image = 'https://steemitimages.com/u/'+proposal.creator+'/avatar/small'\n      proposal.image_receiver = 'https://steemitimages.com/u/'+proposal.receiver+'/avatar/small'\n      proposal.votes_sp = this.witnessVotes2sp(proposal.total_votes)\n      proposal.vote = false\n      proposal.newVote = false\n      proposal.total_time = Utils.textTime(delta_t)\n      proposal.total_pay = (parseFloat(proposal.daily_pay) * delta_t / (1000*60*60*24)).toFixed(3) + ' ' + Config.SBD\n      proposal.active = this.isActive(proposal)\n      proposal.status = proposal.active ? 'active' : 'inactive'\n      if(proposal.active){\n        proposal.status = 'active'\n        proposal.status_extended = ''\n      }else{\n        proposal.status = 'inactive'\n        proposal.status_extended = `(becomes active in ${Utils.textTime(new Date(proposal.start_date+'Z') - Date.now())})`\n      }\n      this.proposal = proposal\n      console.log(`total votes ${proposal.total_votes}`)\n\n      if(this.$store.state.auth.logged) this.loadVotesFromAccount()\n      this.loadVotes()\n    },\n\n    sortBy(type){\n      switch(type){\n        case 'votes':\n          this.votes.sort( (a,b)=>{ return parseInt(b.votes) - parseInt(a.votes) })\n          return\n        case 'name':\n          this.votes.sort( (a,b)=>{ return a.voter.localeCompare(b.voter) })\n          return\n        default:\n          throw new Error(`The type '${type}' for sort does not exists`)\n      }\n    },\n\n    isActive(proposal){\n      var now = Date.now()\n      return now <= new Date(proposal.end_date+'Z') && now >= new Date(proposal.start_date+'Z')\n    },\n\n    async loadVotes(){\n      var proposal = this.proposal\n      proposal.total_votes = 0\n      var from = ''\n      var break_while = false\n      var voters = []\n      while(!break_while){\n        var votes = await this.steem_database_call('list_proposal_votes',[[proposal.id,from],100,'by_proposal_voter'])\n\n        if(votes.length == 1){\n          break_while = true\n          if(votes[0].proposal.id == proposal.id) voters.push(votes[0].voter)\n        }else{\n          for(var j=0; j<votes.length-1; j++){ //don't take the last one. It is for the next round\n            if(votes[j].proposal.id !== proposal.id){\n              break_while = true\n              break\n            }\n            voters.push(votes[j].voter)\n          }\n        }\n        from = votes[votes.length-1].voter\n      }\n      console.log(`voters of id ${proposal.id}`)\n      console.log(voters)\n      this.votes = []\n      var accounts = await this.steem_database_call('get_accounts',[voters])\n      for(var j in accounts){\n        var account = accounts[j]\n        var vote = this.calculate_vote(account)\n        this.votes.push(vote)\n        proposal.total_votes += vote.votes\n      }\n      console.log(`total votes ${proposal.total_votes}`)\n      proposal.votes_sp = this.witnessVotes2sp(proposal.total_votes)\n      this.proposal = proposal\n      this.sortBy(this.sort_order)\n    },\n\n    witness_vote_weight(account) {\n      if(account.proxy !== '') return 0\n      return this.no_proxy_vote_weight(account) + this.proxy_vote_weight(account)\n    },\n\n    no_proxy_vote_weight(account){\n      return Math.floor(parseFloat(account.vesting_shares)*1e6)\n    },\n\n    proxy_vote_weight(account) {\n      var total = 0\n      for(var i in account.proxied_vsf_votes)\n        total += parseInt(account.proxied_vsf_votes[i])\n      return total\n    },\n\n    calculate_vote(account) {\n      var vote = {\n        voter: account.name,\n        votes: this.witness_vote_weight(account),\n        no_proxy_votes: this.no_proxy_vote_weight(account),\n        proxy_votes: this.proxy_vote_weight(account),\n      }\n      if(account.proxy === ''){ //no proxy set\n        vote.votes_sp = this.witnessVotes2sp(vote.votes)\n        if(vote.proxy_votes>0)\n          vote.votes_description = `(${this.witnessVotes2sp(vote.no_proxy_votes)} + ${this.witnessVotes2sp(vote.proxy_votes)} proxy)`\n        else\n          vote.votes_description = ''\n      }else{\n        vote.votes_sp = this.witnessVotes2sp(0)\n        vote.votes_description = `(${this.witnessVotes2sp(vote.no_proxy_votes)}`\n        if(vote.proxy_votes>0)\n          vote.votes_description += ` + ${this.witnessVotes2sp(vote.proxy_votes)} proxy,`\n        vote.votes_description += ` proxied to @${account.proxy})`\n      }\n      return vote\n    },\n\n    async loadVotesFromAccount(){\n      var user = this.$store.state.auth.user\n      var id = this.$route.params.id\n      this.clearVotes()\n      var account_votes = await this.steem_database_call('list_proposal_votes',[[user,id],1,'by_voter_proposal'])\n      if(!account_votes || account_votes.length==0){\n        this.proposal.vote = false\n        this.display_button = 'Vote'\n      }else{\n        this.proposal.vote = true\n        this.display_button = 'Remove vote'\n      }\n    },\n\n    vote(){\n      var user = this.$store.state.auth.user\n      var activeKey = this.$store.state.auth.keys.active\n      var ownerKey  = this.$store.state.auth.keys.owner\n      var privKey = null\n      var id = this.$route.params.id\n\n      if( activeKey != null ) {\n        privKey = activeKey\n      }else if(ownerKey != null ) {\n        privKey = ownerKey\n      }else {\n        this.showDanger('Please login with master, owner, or active key')\n        return\n      }\n\n      var ops = [[\n        'update_proposal_votes',\n        {\n          voter: user,\n          proposal_ids: [id],\n          approve: !this.proposal.vote,\n          extensions: []\n        }\n      ]]\n\n      this.saving = true\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n\n      let self = this\n\n      this.steem_broadcast_sendOperations(ops,privKey)\n      .then(function(result){\n        self.saving = false\n        self.showSuccess(`<a href=\"${Config.EXPLORER2}b/${result.block_num}/${result.id}\" class=\"alert-link\" target=\"_blank\">Vote saved!</a>`)\n        self.loadVotesFromAccount()\n      })\n      .catch(function(error){\n        self.saving = false\n        self.showDanger(error.message)\n        console.log('operations')\n        console.log(ops)\n        throw error\n      })\n    },\n\n    onLogin() {\n      this.loadVotesFromAccount()\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n    },\n\n    onLogout() {\n      this.hideSuccess()\n      this.hideDanger()\n      this.hideInfo()\n    },\n  }\n}\n</script>\n\n<style scoped>\n\n.hash {\n  font-family: monospace;\n  //font-size: 1.3rem;\n  overflow-wrap: break-word;\n}\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProposalPage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProposalPage.vue?vue&type=template&id=7d5ad6e1&scoped=true&\"\nimport script from \"./ProposalPage.vue?vue&type=script&lang=js&\"\nexport * from \"./ProposalPage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ProposalPage.vue?vue&type=style&index=0&id=7d5ad6e1&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7d5ad6e1\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}